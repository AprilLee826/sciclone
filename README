An R package for inferring the subclonal architecture of tumors

Installation instructions:
-------------------------------
First make sure that you have the dependencies:
IRanges, bmm, rgl, RColorBrewer, ggplot2, grid, plotrix, methods

bmm is not yet in the repos and can be grabbed here:
https://github.com/genome/bmm


$ git clone git@github.com:genome/sciclone.git
$ cd sciclone/
$ R CMD build sciClone
$ R CMD INSTALL sciClone_0.4.0.tar.gz


Usage
-------------------------------



library(sciClone)

#read in vaf data
v1 = read.table("data/vafs.tumor1.dat",header=T);
v2 = read.table("data/vafs.tumor2.dat",header=T);
v3 = read.table("data/vafs.tumor3.dat",header=T);

#read in regions to exclude
regions = read.table("data/exclude.loh")

#read in copy number data
cn1 = read.table("data/copy_number_tum1")
cn2 = read.table("data/copy_number_tum2")
cn3 = read.table("data/copy_number_tum3")

#set sample names
names = c("Sample1","Sample2","Sample3")



#Examples:
#---------------
#1d clustering on just one sample
sc = sciClone(vafs=v1,
         copyNumberCalls=cn1,
         sampleNames=names[1],
         regionsToExclude=reg1)
#create output
writeClusterTable(sc, "results/clusters1")
sc.plot1d(sc,"results/clusters1.1d.pdf")



#---------------
#2d clustering using two samples:
sc = sciClone(vafs=list(v1,v2),
              copyNumberCalls=list(cn1,cn2),
              sampleNames=names[1:2],
               regionsToExclude=regions)
#create output
writeClusterTable(sc, "results/clusters2")
sc.plot1d(sc,"results/clusters2.1d.pdf")
sc.plot2d(sc,"results/clusters2.2d.pdf")


#---------------
#3d clustering using three samples:
sc = sciClone(vafs=list(v1,v2,v3),
              copyNumberCalls=list(cn1,cn2,cn3),
              sampleNames=names[1:2],
               regionsToExclude=regions)
#create output
writeClusterTable(sc, "results/clusters2")
sc.plot1d(sc,"results/clusters2.1d.pdf")
sc.plot2d(sc,"results/clusters2.2d.pdf")
sc.plot3d(sc, sc@sampleNames, size=700, outputFile="results/clusters3.3d.gif")


#This pattern generalizes up to N samples, except for plotting, which caps out at 3d for obvious reasons.